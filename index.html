import React, { useState } from 'react';
import { Calculator } from 'lucide-react';

export default function SprintCapacityPlanner() {
  const [rollingSPs, setRollingSPs] = useState('22.29');
  const [workingHoursPerWeek, setWorkingHoursPerWeek] = useState('38.5');
  const [weeksPerSprint, setWeeksPerSprint] = useState('2');
  const [peopleWorking, setPeopleWorking] = useState('5');
  const [workingHoursPerDay, setWorkingHoursPerDay] = useState('7.7');
  const [absenceDays, setAbsenceDays] = useState('5');
  const [buffer, setBuffer] = useState('20');

  // Calculations based on formulas
  const hoursPerSprint = parseFloat(workingHoursPerWeek) * parseFloat(weeksPerSprint);
  const hoursOf100Capacity = hoursPerSprint * parseFloat(peopleWorking);
  const hoursOfAbsence = parseFloat(absenceDays) * parseFloat(workingHoursPerDay);
  const actualHoursPerSprint = hoursOf100Capacity - hoursOfAbsence;
  const capacityExcludingAbsences = (actualHoursPerSprint / hoursOf100Capacity) * 100;
  const bufferSubstracted = (100 - parseFloat(buffer)) / 100;
  const actualSPsPerSprint = parseFloat(rollingSPs) * (capacityExcludingAbsences / 100) * bufferSubstracted;

  const InputField = ({ label, value, onChange, step = "0.1" }) => (
    <div className="mb-4">
      <label className="block text-sm font-medium text-gray-700 mb-1">
        {label}
      </label>
      <input
        type="number"
        value={value}
        onChange={(e) => onChange(e.target.value)}
        step={step}
        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
    </div>
  );

  const ResultField = ({ label, value, isPercentage = false, isHighlight = false }) => (
    <div className={`mb-3 p-3 rounded ${isHighlight ? 'bg-green-100 border-2 border-green-600' : 'bg-gray-50'}`}>
      <div className="text-sm text-gray-600">{label}</div>
      <div className={`text-lg font-semibold ${isHighlight ? 'text-green-800' : 'text-gray-900'}`}>
        {value.toFixed(2)}{isPercentage ? '%' : ''}
      </div>
    </div>
  );

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
      <div className="max-w-6xl mx-auto">
        <div className="bg-white rounded-lg shadow-lg p-8">
          <div className="flex items-center gap-3 mb-6">
            <Calculator className="w-8 h-8 text-blue-600" />
            <h1 className="text-3xl font-bold text-gray-800">Sprint Capacity Planner</h1>
          </div>

          <div className="grid md:grid-cols-2 gap-8">
            {/* Input Section */}
            <div className="space-y-2">
              <h2 className="text-xl font-semibold text-gray-700 mb-4">Input Values</h2>
              
              <InputField
                label="Rolling avg SPs"
                value={rollingSPs}
                onChange={setRollingSPs}
              />
              
              <InputField
                label="Working hours per week"
                value={workingHoursPerWeek}
                onChange={setWorkingHoursPerWeek}
              />
              
              <InputField
                label="Weeks per sprint"
                value={weeksPerSprint}
                onChange={setWeeksPerSprint}
                step="1"
              />
              
              <InputField
                label="People working in sprint"
                value={peopleWorking}
                onChange={setPeopleWorking}
                step="1"
              />

              <InputField
                label="Working hours per day"
                value={workingHoursPerDay}
                onChange={setWorkingHoursPerDay}
              />
              
              <InputField
                label="Total absence days"
                value={absenceDays}
                onChange={setAbsenceDays}
                step="0.5"
              />
              
              <InputField
                label="Buffer (%)"
                value={buffer}
                onChange={setBuffer}
              />
            </div>

            {/* Results Section */}
            <div>
              <h2 className="text-xl font-semibold text-gray-700 mb-4">Calculated Values</h2>
              
              <ResultField
                label="Hours per sprint"
                value={hoursPerSprint}
              />
              
              <ResultField
                label="Hours of 100% capacity"
                value={hoursOf100Capacity}
              />
              
              <ResultField
                label="Hours of absence total"
                value={hoursOfAbsence}
              />
              
              <ResultField
                label="Actual hours per sprint"
                value={actualHoursPerSprint}
              />
              
              <ResultField
                label="Capacity excluding absences"
                value={capacityExcludingAbsences}
                isPercentage={true}
              />
              
              <ResultField
                label="Buffer substracted"
                value={bufferSubstracted * 100}
                isPercentage={true}
              />
              
              <ResultField
                label="Actual SPs per sprint"
                value={actualSPsPerSprint}
                isHighlight={true}
              />
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
