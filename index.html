<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprint Capacity Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font and base styles */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f7f7f9; /* Light background */
        }
        /* Custom styling for read-only fields (Results) */
        .result-field {
            background-color: #f0f4f8; 
            border: 1px solid #e2e8f0;
        }
        /* Highlight styling for the final result */
        .highlight-field {
            background-color: #4f46e5; /* Indigo */
            color: white;
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.4), 0 2px 4px -2px rgba(79, 70, 229, 0.4);
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8 min-h-screen flex items-center justify-center">

    <!-- Container wurde auf max-w-sm reduziert, um die Sidebar besser zu simulieren -->
    <div class="w-full max-w-sm bg-white rounded-2xl shadow-2xl p-6 sm:p-10">
        
        <!-- Header ohne Icon -->
        <div class="flex items-center mb-8 border-b pb-4">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800 tracking-tight">Sprint Capacity Planner</h1>
        </div>

        <!-- Layout wurde auf EINE Spalte (grid-cols-1) umgestellt, um Stapelung zu erzwingen -->
        <div class="grid grid-cols-1 gap-y-6">
            
            <!-- INPUT SECTION -->
            <div id="input-section" class="space-y-4 p-4 bg-gray-50 rounded-xl border border-gray-100">
                <h2 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">Variables (Editable)</h2>
                
                <div class="flex flex-col">
                    <label for="inputRollingSPs" class="text-sm font-medium text-gray-700 mb-1">Rolling AVG SPs (Past Velocity)</label>
                    <input type="number" id="inputRollingSPs" value="22.29" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150">
                </div>

                <div class="flex flex-col">
                    <label for="inputHoursPerWeek" class="text-sm font-medium text-gray-700 mb-1">Working hours per week</label>
                    <input type="number" id="inputHoursPerWeek" value="38.5" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150">
                </div>
                
                <div class="flex flex-col">
                    <label for="inputWeeksPerSprint" class="text-sm font-medium text-gray-700 mb-1">Weeks per sprint</label>
                    <input type="number" id="inputWeeksPerSprint" value="2" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150">
                </div>
                
                <div class="flex flex-col">
                    <label for="inputPeopleWorking" class="text-sm font-medium text-gray-700 mb-1">People working in sprint</label>
                    <input type="number" id="inputPeopleWorking" value="5" step="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150">
                </div>

                <div class="flex flex-col">
                    <label for="inputHoursPerDay" class="text-sm font-medium text-gray-700 mb-1">Working hours per day</label>
                    <input type="number" id="inputHoursPerDay" value="7.7" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150">
                </div>
                
                <div class="flex flex-col">
                    <label for="inputAbsenceDays" class="text-sm font-medium text-gray-700 mb-1">Total absence days</label>
                    <input type="number" id="inputAbsenceDays" value="5" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150">
                </div>
                
                <div class="flex flex-col">
                    <label for="inputBuffer" class="text-sm font-medium text-gray-700 mb-1">Buffer (%) (SRs, Bugs, etc.)</label>
                    <input type="number" id="inputBuffer" value="20" step="1" min="0" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150">
                </div>
            </div>

            <!-- RESULTS SECTION -->
            <div id="results-section" class="space-y-4">
                <h2 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">Results (Protected)</h2>
                
                <div class="p-4 rounded-xl result-field">
                    <div class="text-sm text-gray-500">Hours per sprint (Total)</div>
                    <div id="outputHoursPerSprint" class="text-xl font-bold tracking-tight text-gray-800"></div>
                </div>

                <div class="p-4 rounded-xl result-field">
                    <div class="text-sm text-gray-500">Hours of 100% capacity</div>
                    <div id="outputHoursOf100Capacity" class="text-xl font-bold tracking-tight text-gray-800"></div>
                </div>
                
                <div class="p-4 rounded-xl result-field">
                    <div class="text-sm text-gray-500">Hours of absence total</div>
                    <div id="outputHoursOfAbsence" class="text-xl font-bold tracking-tight text-gray-800"></div>
                </div>
                
                <div class="p-4 rounded-xl result-field">
                    <div class="text-sm text-gray-500">Actual hours per sprint</div>
                    <div id="outputActualHoursPerSprint" class="text-xl font-bold tracking-tight text-gray-800"></div>
                </div>
                
                <div class="p-4 rounded-xl result-field">
                    <div class="text-sm text-gray-500">Capacity excluding absences</div>
                    <div id="outputCapacityExcludingAbsences" class="text-xl font-bold tracking-tight text-gray-800"></div>
                </div>
                
                <div class="p-4 rounded-xl result-field">
                    <div class="text-sm text-gray-500">Effective Capacity Multiplier (100% - Buffer)</div>
                    <div id="outputBufferSubstracted" class="text-xl font-bold tracking-tight text-gray-800"></div>
                </div>
                
                <div class="p-4 rounded-xl highlight-field">
                    <div class="text-sm text-indigo-200">Actual SPs per sprint</div>
                    <div id="outputActualSPsPerSprint" class="text-2xl font-extrabold tracking-tight text-white"></div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // Helper function to safely parse string state to float, defaulting to 0
        const safeParseFloat = (id) => {
            const element = document.getElementById(id);
            const parsed = parseFloat(element.value);
            return isNaN(parsed) ? 0 : parsed;
        };

        const safeDivide = (numerator, denominator) => {
            return denominator === 0 ? 0 : numerator / denominator;
        };

        function calculateCapacity() {
            // --- 1. Get Inputs (IDs match the HTML fields) ---
            const rSPs = safeParseFloat('inputRollingSPs');
            const wHPW = safeParseFloat('inputHoursPerWeek');
            const wPS = safeParseFloat('inputWeeksPerSprint');
            const pW = safeParseFloat('inputPeopleWorking');
            const wHPD = safeParseFloat('inputHoursPerDay');
            const aD = safeParseFloat('inputAbsenceDays');
            const b = safeParseFloat('inputBuffer');

            // --- 2. Calculations (Based on React Logic) ---
            
            // 1. Hours per sprint (Total team hours per sprint)
            const hoursPerSprint = wHPW * wPS;
            
            // 2. Hours of 100% capacity
            const hoursOf100Capacity = hoursPerSprint * pW;
            
            // 3. Hours of absence total
            const hoursOfAbsence = aD * wHPD;
            
            // 4. Actual hours per sprint (Capacity - Absence)
            const actualHoursPerSprint = hoursOf100Capacity - hoursOfAbsence;
            
            // 5. Capacity excluding absences (%)
            const capacityExcludingAbsences = safeDivide(actualHoursPerSprint, hoursOf100Capacity) * 100;

            // 6. Buffer multiplier
            const bufferSubstracted = safeDivide((100 - b), 100);
            
            // 7. Actual SPs per sprint (The estimated outcome)
            const actualSPsPerSprint = rSPs * safeDivide(capacityExcludingAbsences, 100) * bufferSubstracted;

            // --- 3. Update Results in UI ---
            document.getElementById('outputHoursPerSprint').textContent = hoursPerSprint.toFixed(2) + ' hrs';
            document.getElementById('outputHoursOf100Capacity').textContent = hoursOf100Capacity.toFixed(2) + ' hrs';
            document.getElementById('outputHoursOfAbsence').textContent = hoursOfAbsence.toFixed(2) + ' hrs';
            document.getElementById('outputActualHoursPerSprint').textContent = actualHoursPerSprint.toFixed(2) + ' hrs';
            document.getElementById('outputCapacityExcludingAbsences').textContent = capacityExcludingAbsences.toFixed(2) + '%';
            document.getElementById('outputBufferSubstracted').textContent = (bufferSubstracted * 100).toFixed(2) + '%';
            document.getElementById('outputActualSPsPerSprint').textContent = actualSPsPerSprint.toFixed(2);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const inputElements = document.querySelectorAll('#input-section input');
            
            // Attach the calculation function to every input event
            inputElements.forEach(input => {
                input.addEventListener('input', calculateCapacity);
            });

            // Run initial calculation when the page loads
            calculateCapacity();
        });
    </script>
</body>
</html>
